Number of samples: 10
Fold change: 0.1
Loading required package: foreach
Loading required package: iterators
Loading required package: parallel
[1] 15
'getOption("repos")' replaces Bioconductor standard repositories, see
'help("repositories", package = "BiocManager")' for details.
Replacement repositories:
    CRAN: https://cloud.r-project.org/
Bioconductor version 3.19 (BiocManager 1.30.25), R 4.4.1 (2024-06-14)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.5
✔ lubridate 1.9.3     ✔ stringr   1.5.1
✔ purrr     1.0.2     ✔ tibble    3.2.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ purrr::accumulate() masks foreach::accumulate()
✖ dplyr::filter()     masks stats::filter()
✖ dplyr::lag()        masks stats::lag()
✖ purrr::when()       masks foreach::when()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

Attaching package: ‘MASS’

The following object is masked from ‘package:dplyr’:

    select

Loading required package: lattice

Attaching package: ‘caret’

The following object is masked from ‘package:purrr’:

    lift

Loading required package: SeuratObject
Loading required package: sp
‘SeuratObject’ was built under R 4.4.0 but the current version is
4.4.1; it is recomended that you reinstall ‘SeuratObject’ as the ABI
for R may have changed

Attaching package: ‘SeuratObject’

The following objects are masked from ‘package:base’:

    intersect, t


Attaching package: ‘stevemisc’

The following object is masked from ‘package:lubridate’:

    dst

The following object is masked from ‘package:dplyr’:

    tbl_df

Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack


Attaching package: ‘ggh4x’

The following object is masked from ‘package:ggplot2’:

    guide_axis_logticks

Loading required package: limma
Loading required package: BiocParallel
Registered S3 method overwritten by 'EnvStats':
  method         from
  print.estimate lava

Attaching package: ‘variancePartition’

The following object is masked from ‘package:limma’:

    topTable


Attaching package: ‘data.table’

The following objects are masked from ‘package:lubridate’:

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year

The following object is masked from ‘package:purrr’:

    transpose

The following objects are masked from ‘package:dplyr’:

    between, first, last

Loading required package: Rcpp
Warning messages:
1: package(s) not installed when version(s) same as or greater than current; use
  `force = TRUE` to re-install: 'BiocVersion' 
2: package(s) not installed when version(s) same as or greater than current; use
  `force = TRUE` to re-install: 'AnnotationDbi' 'AnnotationHub' 'basilisk'
  'basilisk.utils' 'beachmat' 'Biobase' 'BiocBaseUtils' 'BiocFileCache'
  'BiocGenerics' 'BiocNeighbors' 'BiocParallel' 'BiocSingular' 'BiocVersion'
  'Biostrings' 'bluster' 'DECIPHER' 'decontam' 'DelayedArray'
  'DelayedMatrixStats' 'dir.expiry' 'DirichletMultinomial' 'edgeR'
  'ExperimentHub' 'GenomeInfoDb' 'GenomicRanges' 'HDF5Array' 'IRanges'
  'KEGGREST' 'limma' 'MatrixGenerics' 'metapod' 'mia' 'miloR' 'MOFA2'
  'MultiAssayExperiment' 'rhdf5' 'rhdf5filters' 'Rhdf5lib' 'S4Arrays'
  'S4Vectors' 'ScaledMatrix' 'scater' 'scran' 'scuttle' 'SingleCellExperiment'
  'SparseArray' 'sparseMatrixStats' 'SummarizedExperiment' 'treeio'
  'TreeSummarizedExperiment' 'UCSC.utils' 'variancePartition' 'XVector'
  'zellkonverter' 'zlibbioc' 'curatedMetagenomicData' 
# A tibble: 6 × 3
  subject_id   pro count
  <chr>      <dbl> <int>
1 SUB_1       1.02   102
2 SUB_10      1.09   109
3 SUB_2       0.99    99
4 SUB_3       0.9     90
5 SUB_4       1      100
6 SUB_5       1.05   105
[1] "Inside diff cell types. diff =  11"
[1] "n_cells =  100 ; median pro =  1.035  ; median pro increase =  1.1385"
[1] "i =  A"
[1] "len =  55"
[1] "Inside control cell types. diff_control =  202"
[1] "n_cells =  100 ; median pro =  0.96  ; median pro control =  0.096"
[1] "len =  1010"
[1] "Inside control cell types. diff_control =  214"
[1] "n_cells =  100 ; median pro =  1.015  ; median pro control =  0.1015"
[1] "len =  1070"
[1] "Inside control cell types. diff_control =  208"
[1] "n_cells =  100 ; median pro =  0.99  ; median pro control =  0.099"
[1] "len =  1040"
[1] "Inside control cell types. diff_control =  204"
[1] "n_cells =  100 ; median pro =  0.97  ; median pro control =  0.097"
[1] "len =  1020"
[1] "Inside control cell types. diff_control =  209"
[1] "n_cells =  100 ; median pro =  0.995  ; median pro control =  0.0995"
[1] "len =  1045"
[1] "Inside control cell types. diff_control =  209"
[1] "n_cells =  100 ; median pro =  0.995  ; median pro control =  0.0995"
[1] "len =  1045"
[1] "Inside control cell types. diff_control =  86"
[1] "n_cells =  100 ; median pro =  0.405  ; median pro control =  0.0405"
[1] "len =  430"
[1] "Inside control cell types. diff_control =  84"
[1] "n_cells =  100 ; median pro =  0.4  ; median pro control =  0.04"
[1] "len =  420"
# A tibble: 6 × 3
  subject_id   pro count
  <chr>      <dbl> <int>
1 SUB_1       0.38    38
2 SUB_10      0.41    41
3 SUB_2       0.39    39
4 SUB_3       0.41    41
5 SUB_4       0.37    37
6 SUB_5       0.4     40
[1] "Inside diff cell types. diff =  4"
[1] "n_cells =  100 ; median pro =  0.395  ; median pro increase =  0.4345"
[1] "i =  J"
[1] "len =  20"
 [1] 0.15298913 0.14143804 0.13017248 0.10797077 0.10195500 0.08373785
 [7] 0.05819754 0.05297998 0.02831092 0.01315769 0.01312122 0.01303953
[13] 0.01294177 0.01292766 0.01290617 0.01289286 0.01285518 0.01284021
[19] 0.01279437 0.01277162
Warning message:
`funs()` was deprecated in dplyr 0.8.0.
ℹ Please use a list of either functions or lambdas:

# Simple named list: list(mean = mean, median = median)

# Auto named with `tibble::lst()`: tibble::lst(mean, median)

# Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm = TRUE)) 
Warning message:
`aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information. 
'as(<matrix>, "dgTMatrix")' is deprecated.
Use 'as(as(as(., "dMatrix"), "generalMatrix"), "TsparseMatrix")' instead.
See help("Deprecated") and help("Matrix-deprecated").
Warning: Data is of class dgTMatrix. Coercing to dgCMatrix.
Computing nearest neighbor graph
Computing SNN
stopping after 4 steps
filtering based on batches kurtosis
throwing out neighborhoods with batch kurtosis >= 6
Residualize NAM
Decompose NAM
computing neighborhood-level FDRs
Warning message:
No assay specified, setting assay as RNA by default. 
`summarise()` has grouped output by 'subject_id', 'sex', 'disease'. You can
override using the `.groups` argument.
`summarise()` has grouped output by 'subject_id', 'sex', 'disease'. You can
override using the `.groups` argument.
Warning message:
`funs()` was deprecated in dplyr 0.8.0.
ℹ Please use a list of either functions or lambdas:

# Simple named list: list(mean = mean, median = median)

# Auto named with `tibble::lst()`: tibble::lst(mean, median)

# Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm = TRUE)) 
Warning messages:
1: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead. 
2: In min(cor_pos) : no non-missing arguments to min; returning Inf
3: In max(cor_neg) : no non-missing arguments to max; returning -Inf
Warning messages:
1: In min(cor_pos) : no non-missing arguments to min; returning Inf
2: In max(cor_neg) : no non-missing arguments to max; returning -Inf
Warning message:
In wilcox.test.default(c(4.54950936663693, 4.4404973357016, 4.72547254725473,  :
  cannot compute exact p-value with ties
Warning message:
In wilcox.test.default(c(4.54950936663693, 4.4404973357016, 4.72547254725473,  :
  cannot compute exact p-value with ties
Transposing data matrix
Initializing state using k-means centroids initialization
Harmony 1/10
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Harmony 2/10
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Harmony 3/10
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
Harmony converged after 3 iterations
Picking joint bandwidth of 0.000949
Picking joint bandwidth of 0.0012
Picking joint bandwidth of 0.00119
Picking joint bandwidth of 0.00114
Picking joint bandwidth of 0.00109
Picking joint bandwidth of 0.00107
Picking joint bandwidth of 0.00107
Picking joint bandwidth of 0.000312
Picking joint bandwidth of 0.000708
Picking joint bandwidth of 0.000949
Picking joint bandwidth of 0.0012
Picking joint bandwidth of 0.00119
Picking joint bandwidth of 0.00114
Picking joint bandwidth of 0.00109
Picking joint bandwidth of 0.00107
Picking joint bandwidth of 0.00107
Picking joint bandwidth of 0.000312
Picking joint bandwidth of 0.000708
Picking joint bandwidth of 0.000671
Picking joint bandwidth of 0.00132
Picking joint bandwidth of 0.00146
Picking joint bandwidth of 0.00144
Picking joint bandwidth of 0.00135
Picking joint bandwidth of 0.00142
Picking joint bandwidth of 0.00139
Picking joint bandwidth of 0.00042
Picking joint bandwidth of 0.000967
Picking joint bandwidth of 0.000671
Picking joint bandwidth of 0.00132
Picking joint bandwidth of 0.00146
Picking joint bandwidth of 0.00144
Picking joint bandwidth of 0.00135
Picking joint bandwidth of 0.00142
Picking joint bandwidth of 0.00139
Picking joint bandwidth of 0.00042
Picking joint bandwidth of 0.000967
Error: object 'file_prefix' not found
Execution halted
