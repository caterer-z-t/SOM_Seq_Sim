<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="References &amp; Acknowledgements" href="../references.html" /><link rel="prev" title="SOM Example Titanic" href="../som_example_titanic.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.08.06 -->
        <title>Hyperparameter Tuning Example for Self-Organizing Maps (SOM) - SOM_Seq_Sim 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">SOM_Seq_Sim 1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/som_package_logo.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">SOM_Seq_Sim 1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Project Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html"><strong>Self-Organizing Maps to Explore Genetic Sequencing Simulation Data (SOM-Seq)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_overview.html">Data Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules.html">Core Function Descriptions</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Core Function Descriptions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../SOM_Seq_Sim.html">SOM Core Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Seq_Sim.html">Seq_Sim Core Functions</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Setup &amp; Walkthroughs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generate_data.html">Generating Sequencing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../make_soms.html">Creating SOMs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../make_soms.html#inputs">Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../make_soms.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../make_soms.html#outputs">Outputs</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../walkthrough.html">Walkthroughs</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Walkthroughs</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../seq_sim_workflow.html">Seq Sim Workflow</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Seq Sim Workflow</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="seq_sim_workflow.html">1. Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="seq_sim_workflow.html#2.-Specify-Number-of-Samples-and-Fold-Change">2. Specify Number of Samples and Fold Change</a></li>
<li class="toctree-l3"><a class="reference internal" href="seq_sim_workflow.html#3.-Specify-Configuration-File-Parameters">3. Specify Configuration File Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="seq_sim_workflow.html#4.-Generate-and-Save-Sequencing-Data">4. Generate and Save Sequencing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="seq_sim_workflow.html#5.-Ensure-files-were-saved-properly">5. Ensure files were saved properly</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../som_example_iris.html">SOM Example Iris</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of SOM Example Iris</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html">Basic Example of Using the Self-Organizing Map (SOM) Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html#1.-Imports">1. Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html#2.-Load-Data">2. Load Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html#3.-Train-SOM">3. Train SOM</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html#4.-Get-Fit-Metrics">4. Get Fit Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html#5.-Plot-SOM's-(see-output-directory-for-figures)">5. Plot SOM’s (see output directory for figures)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../som_example_seq.html">SOM Example Seq</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of SOM Example Seq</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="som_example_seq.html">Application of Self-Organizing Maps (SOM) for Cell Type Identification</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_seq.html#1.-Imports">1. Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_seq.html#2.-Load-Data">2. Load Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_seq.html#3.-Train-SOM">3. Train SOM</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_seq.html#4.-Plot-layout-of-SOM-with-neuron-IDs">4. Plot layout of SOM with neuron IDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_seq.html#5.-Plot-component-planes-and-categorical-data-(see-output-directory-for-figures)">5. Plot component planes and categorical data (see output directory for figures)</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_seq.html#6.-Custom-plotting-for-seq-visualization-for-each-neuron">6. Custom plotting for seq visualization for each neuron</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../som_example_titanic.html">SOM Example Titanic</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of SOM Example Titanic</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Hyperparameter Tuning Example for Self-Organizing Maps (SOM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1.-Imports">1. Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Load-Data">2. Load Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.-Define-Hyperparameters">3. Define Hyperparameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.-Grid-Search-for-Optimal-Parameters">4. Grid Search for Optimal Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#5.-Show-the-best-parameters">5. Show the best parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#6.-Train-SOM">6. Train SOM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#7.-Get-the-Fit-Metrics">7. Get the Fit Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#8.-Plot-component-planes-and-categorical-data-(see-output-directory-for-figures)">8. Plot component planes and categorical data (see output directory for figures)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References &amp; Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/caterer-z-t/SOM_Seq_Sim">Link to Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing to SOM_Seq_Sim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT.html">Code of Conduct - SOM_Seq_Sim</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/examples/som_example_titanic.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="Hyperparameter-Tuning-Example-for-Self-Organizing-Maps-(SOM)">
<h1>Hyperparameter Tuning Example for Self-Organizing Maps (SOM)<a class="headerlink" href="#Hyperparameter-Tuning-Example-for-Self-Organizing-Maps-(SOM)" title="Permalink to this heading">¶</a></h1>
<p>This script demonstrates how to use the SOM class to perform hyperparameter tuning. By defining a grid of hyperparameters and systematically testing all combinations, the script identifies the optimal configuration of hyperparameters for a given dataset.</p>
<section id="Features-of-This-Script:">
<h2>Features of This Script:<a class="headerlink" href="#Features-of-This-Script:" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Grid Search Implementation:</p>
<ul class="simple">
<li><p>Hyperparameters such as <code class="docutils literal notranslate"><span class="pre">scale_method</span></code>, <code class="docutils literal notranslate"><span class="pre">x_dim</span></code>, <code class="docutils literal notranslate"><span class="pre">y_dim</span></code>, <code class="docutils literal notranslate"><span class="pre">topology</span></code>, <code class="docutils literal notranslate"><span class="pre">neighborhood_fnc</span></code>, and <code class="docutils literal notranslate"><span class="pre">epochs</span></code> are systematically tested over a predefined range of values.</p></li>
<li><p>The metrics Percent Variance Explained (PVE) and Topographic Error are combined into a scoring function to evaluate the SOM’s performance for each combination.</p></li>
</ul>
</li>
<li><p>Ease of Use:</p>
<ul class="simple">
<li><p>The script leverages Python’s <code class="docutils literal notranslate"><span class="pre">itertools.product</span></code> for a clean and systematic exploration of hyperparameter combinations.</p></li>
<li><p>Metrics are calculated using the SOM class’ built-in methods, making the evaluation process seamless.</p></li>
</ul>
</li>
<li><p>Visualization of Results:</p>
<ul class="simple">
<li><p>Once the best hyperparameters are identified, the SOM is retrained, and component planes and categorical data distributions are visualized and saved.</p></li>
</ul>
</li>
</ol>
</section>
<section id="Considerations:">
<h2>Considerations:<a class="headerlink" href="#Considerations:" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Time Complexity:</p>
<ul>
<li><p>Depending on the size of the dataset and the number of hyperparameter combinations, this process may take significant time. Adjust the ranges of the hyperparameters to balance between thoroughness and computational efficiency.</p></li>
</ul>
</li>
<li><p>Extensibility:</p>
<ul>
<li><p>The scoring function can be adjusted based on specific requirements. In this example, the score is computed as PVE minus a scaled Topographic Error.</p></li>
</ul>
</li>
</ul>
</section>
<section id="Output:">
<h2>Output:<a class="headerlink" href="#Output:" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Best hyperparameters and their resulting score</p></li>
<li><p>Final SOM trained with the best parameters.</p></li>
<li><p>Saved visualizations of component planes and categorical data distributions.</p></li>
</ul>
</section>
<section id="Usage:">
<h2>Usage:<a class="headerlink" href="#Usage:" title="Permalink to this heading">¶</a></h2>
<p>Modify the dataset path and hyperparameter grid as needed.</p>
</section>
</section>
<section id="1.-Imports">
<h1>1. Imports<a class="headerlink" href="#1.-Imports" title="Permalink to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standard imports</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Third party imports</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Local imports</span>
<span class="n">notebook_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">parent_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">notebook_dir</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent_dir</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">SOM.utils.som_utils</span> <span class="kn">import</span> <span class="n">SOM</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Load-Data">
<h1>2. Load Data<a class="headerlink" href="#2.-Load-Data" title="Permalink to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load data</span>
<span class="n">train_dat_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parent_dir</span><span class="p">,</span> <span class="s1">&#39;SOM&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;titanic_training_data.csv&#39;</span><span class="p">)</span>
<span class="n">other_dat_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parent_dir</span><span class="p">,</span> <span class="s1">&#39;SOM&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;titanic_categorical_data.csv&#39;</span><span class="p">)</span>

<span class="n">train_dat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">train_dat_path</span><span class="p">)</span>
<span class="n">other_dat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">other_dat_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="3.-Define-Hyperparameters">
<h1>3. Define Hyperparameters<a class="headerlink" href="#3.-Define-Hyperparameters" title="Permalink to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define hyperparameter grid</span>
<span class="n">hyperparameter_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;scale_method&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;zscore&quot;</span><span class="p">,</span> <span class="s2">&quot;minmax&quot;</span><span class="p">],</span>
    <span class="s2">&quot;x_dim&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="s2">&quot;y_dim&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="s2">&quot;topology&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;rectangular&quot;</span><span class="p">,</span> <span class="s2">&quot;hexagonal&quot;</span><span class="p">],</span>
    <span class="s2">&quot;neighborhood_fnc&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span> <span class="s2">&quot;bubble&quot;</span><span class="p">],</span>
    <span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
<span class="p">}</span>

<span class="c1"># Initialize variables to store the best parameters and score</span>
<span class="n">best_params</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">best_score</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="4.-Grid-Search-for-Optimal-Parameters">
<h1>4. Grid Search for Optimal Parameters<a class="headerlink" href="#4.-Grid-Search-for-Optimal-Parameters" title="Permalink to this heading">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>
    <span class="n">hyperparameter_grid</span><span class="p">[</span><span class="s2">&quot;scale_method&quot;</span><span class="p">],</span>
    <span class="n">hyperparameter_grid</span><span class="p">[</span><span class="s2">&quot;x_dim&quot;</span><span class="p">],</span>
    <span class="n">hyperparameter_grid</span><span class="p">[</span><span class="s2">&quot;y_dim&quot;</span><span class="p">],</span>
    <span class="n">hyperparameter_grid</span><span class="p">[</span><span class="s2">&quot;topology&quot;</span><span class="p">],</span>
    <span class="n">hyperparameter_grid</span><span class="p">[</span><span class="s2">&quot;neighborhood_fnc&quot;</span><span class="p">],</span>
    <span class="n">hyperparameter_grid</span><span class="p">[</span><span class="s2">&quot;epochs&quot;</span><span class="p">],</span>
<span class="p">):</span>
    <span class="n">scale_method</span><span class="p">,</span> <span class="n">x_dim</span><span class="p">,</span> <span class="n">y_dim</span><span class="p">,</span> <span class="n">topology</span><span class="p">,</span> <span class="n">neighborhood_fnc</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">=</span> <span class="n">params</span>

    <span class="c1"># Train SOM with the current hyperparameter combination</span>
    <span class="n">som</span> <span class="o">=</span> <span class="n">SOM</span><span class="p">(</span>
        <span class="n">train_dat</span><span class="o">=</span><span class="n">train_dat</span><span class="p">,</span>
        <span class="n">other_dat</span><span class="o">=</span><span class="n">other_dat</span><span class="p">,</span>
        <span class="n">scale_method</span><span class="o">=</span><span class="n">scale_method</span><span class="p">,</span>
        <span class="n">x_dim</span><span class="o">=</span><span class="n">x_dim</span><span class="p">,</span>
        <span class="n">y_dim</span><span class="o">=</span><span class="n">y_dim</span><span class="p">,</span>
        <span class="n">topology</span><span class="o">=</span><span class="n">topology</span><span class="p">,</span>
        <span class="n">neighborhood_fnc</span><span class="o">=</span><span class="n">neighborhood_fnc</span><span class="p">,</span>
        <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">som</span><span class="o">.</span><span class="n">train_map</span><span class="p">()</span>

    <span class="c1"># Calculate evaluation metrics</span>
    <span class="n">pve</span> <span class="o">=</span> <span class="n">som</span><span class="o">.</span><span class="n">calculate_percent_variance_explained</span><span class="p">()</span>
    <span class="n">topographic_error</span> <span class="o">=</span> <span class="n">som</span><span class="o">.</span><span class="n">calculate_topographic_error</span><span class="p">()</span>

    <span class="c1"># Combine metrics into a single score (higher PVE and lower error are better)</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">pve</span> <span class="o">-</span> <span class="n">topographic_error</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tested params: </span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> | Score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Update the best parameters if the current score is better</span>
    <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">best_score</span><span class="p">:</span>
        <span class="n">best_score</span> <span class="o">=</span> <span class="n">score</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">params</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Tested params: (&#39;zscore&#39;, 3, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 50) | Score: 3.07
Tested params: (&#39;zscore&#39;, 3, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 100) | Score: 22.30
Tested params: (&#39;zscore&#39;, 3, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 200) | Score: 3.37
Tested params: (&#39;zscore&#39;, 3, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 50) | Score: 44.65
Tested params: (&#39;zscore&#39;, 3, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 100) | Score: 32.29
Tested params: (&#39;zscore&#39;, 3, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 200) | Score: -31.86
Tested params: (&#39;zscore&#39;, 3, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 50) | Score: 4.90
Tested params: (&#39;zscore&#39;, 3, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 100) | Score: 34.35
Tested params: (&#39;zscore&#39;, 3, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 200) | Score: 29.17
Tested params: (&#39;zscore&#39;, 3, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 50) | Score: 44.93
Tested params: (&#39;zscore&#39;, 3, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 100) | Score: 47.56
Tested params: (&#39;zscore&#39;, 3, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 200) | Score: 33.27
Tested params: (&#39;zscore&#39;, 3, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 50) | Score: 27.55
Tested params: (&#39;zscore&#39;, 3, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 100) | Score: 54.05
Tested params: (&#39;zscore&#39;, 3, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 200) | Score: 56.14
Tested params: (&#39;zscore&#39;, 3, 4, &#39;rectangular&#39;, &#39;bubble&#39;, 50) | Score: 34.40
Tested params: (&#39;zscore&#39;, 3, 4, &#39;rectangular&#39;, &#39;bubble&#39;, 100) | Score: -6.10
Tested params: (&#39;zscore&#39;, 3, 4, &#39;rectangular&#39;, &#39;bubble&#39;, 200) | Score: -1.29
Tested params: (&#39;zscore&#39;, 3, 4, &#39;hexagonal&#39;, &#39;gaussian&#39;, 50) | Score: 56.96
Tested params: (&#39;zscore&#39;, 3, 4, &#39;hexagonal&#39;, &#39;gaussian&#39;, 100) | Score: 60.51
Tested params: (&#39;zscore&#39;, 3, 4, &#39;hexagonal&#39;, &#39;gaussian&#39;, 200) | Score: 46.69
Tested params: (&#39;zscore&#39;, 3, 4, &#39;hexagonal&#39;, &#39;bubble&#39;, 50) | Score: 39.58
Tested params: (&#39;zscore&#39;, 3, 4, &#39;hexagonal&#39;, &#39;bubble&#39;, 100) | Score: -5.54
Tested params: (&#39;zscore&#39;, 3, 4, &#39;hexagonal&#39;, &#39;bubble&#39;, 200) | Score: 44.09
Tested params: (&#39;zscore&#39;, 3, 6, &#39;rectangular&#39;, &#39;gaussian&#39;, 50) | Score: 47.69
Tested params: (&#39;zscore&#39;, 3, 6, &#39;rectangular&#39;, &#39;gaussian&#39;, 100) | Score: 64.72
Tested params: (&#39;zscore&#39;, 3, 6, &#39;rectangular&#39;, &#39;gaussian&#39;, 200) | Score: 41.66
Tested params: (&#39;zscore&#39;, 3, 6, &#39;rectangular&#39;, &#39;bubble&#39;, 50) | Score: 0.07
Tested params: (&#39;zscore&#39;, 3, 6, &#39;rectangular&#39;, &#39;bubble&#39;, 100) | Score: -8.68
Tested params: (&#39;zscore&#39;, 3, 6, &#39;rectangular&#39;, &#39;bubble&#39;, 200) | Score: -10.00
Tested params: (&#39;zscore&#39;, 3, 6, &#39;hexagonal&#39;, &#39;gaussian&#39;, 50) | Score: 65.04
Tested params: (&#39;zscore&#39;, 3, 6, &#39;hexagonal&#39;, &#39;gaussian&#39;, 100) | Score: 61.91
Tested params: (&#39;zscore&#39;, 3, 6, &#39;hexagonal&#39;, &#39;gaussian&#39;, 200) | Score: 62.98
Tested params: (&#39;zscore&#39;, 3, 6, &#39;hexagonal&#39;, &#39;bubble&#39;, 50) | Score: 2.17
Tested params: (&#39;zscore&#39;, 3, 6, &#39;hexagonal&#39;, &#39;bubble&#39;, 100) | Score: -0.42
Tested params: (&#39;zscore&#39;, 3, 6, &#39;hexagonal&#39;, &#39;bubble&#39;, 200) | Score: -9.16
Tested params: (&#39;zscore&#39;, 5, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 50) | Score: 32.92
Tested params: (&#39;zscore&#39;, 5, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 100) | Score: 37.05
Tested params: (&#39;zscore&#39;, 5, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 200) | Score: 20.39
Tested params: (&#39;zscore&#39;, 5, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 50) | Score: -24.19
Tested params: (&#39;zscore&#39;, 5, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 100) | Score: 2.37
Tested params: (&#39;zscore&#39;, 5, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 200) | Score: -4.35
Tested params: (&#39;zscore&#39;, 5, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 50) | Score: 44.14
Tested params: (&#39;zscore&#39;, 5, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 100) | Score: 49.50
Tested params: (&#39;zscore&#39;, 5, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 200) | Score: 17.55
Tested params: (&#39;zscore&#39;, 5, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 50) | Score: -23.91
Tested params: (&#39;zscore&#39;, 5, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 100) | Score: 4.89
Tested params: (&#39;zscore&#39;, 5, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 200) | Score: 2.65
Tested params: (&#39;zscore&#39;, 5, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 50) | Score: 46.99
Tested params: (&#39;zscore&#39;, 5, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 100) | Score: 60.28
Tested params: (&#39;zscore&#39;, 5, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 200) | Score: 60.30
Tested params: (&#39;zscore&#39;, 5, 4, &#39;rectangular&#39;, &#39;bubble&#39;, 50) | Score: -4.70
Tested params: (&#39;zscore&#39;, 5, 4, &#39;rectangular&#39;, &#39;bubble&#39;, 100) | Score: 33.40
Tested params: (&#39;zscore&#39;, 5, 4, &#39;rectangular&#39;, &#39;bubble&#39;, 200) | Score: 30.51
Tested params: (&#39;zscore&#39;, 5, 4, &#39;hexagonal&#39;, &#39;gaussian&#39;, 50) | Score: 73.81
Tested params: (&#39;zscore&#39;, 5, 4, &#39;hexagonal&#39;, &#39;gaussian&#39;, 100) | Score: 65.29
Tested params: (&#39;zscore&#39;, 5, 4, &#39;hexagonal&#39;, &#39;gaussian&#39;, 200) | Score: 60.89
Tested params: (&#39;zscore&#39;, 5, 4, &#39;hexagonal&#39;, &#39;bubble&#39;, 50) | Score: 29.75
Tested params: (&#39;zscore&#39;, 5, 4, &#39;hexagonal&#39;, &#39;bubble&#39;, 100) | Score: 36.90
Tested params: (&#39;zscore&#39;, 5, 4, &#39;hexagonal&#39;, &#39;bubble&#39;, 200) | Score: 32.61
Tested params: (&#39;zscore&#39;, 5, 6, &#39;rectangular&#39;, &#39;gaussian&#39;, 50) | Score: 66.65
Tested params: (&#39;zscore&#39;, 5, 6, &#39;rectangular&#39;, &#39;gaussian&#39;, 100) | Score: 72.04
Tested params: (&#39;zscore&#39;, 5, 6, &#39;rectangular&#39;, &#39;gaussian&#39;, 200) | Score: 61.56
Tested params: (&#39;zscore&#39;, 5, 6, &#39;rectangular&#39;, &#39;bubble&#39;, 50) | Score: 0.09
Tested params: (&#39;zscore&#39;, 5, 6, &#39;rectangular&#39;, &#39;bubble&#39;, 100) | Score: 1.35
Tested params: (&#39;zscore&#39;, 5, 6, &#39;rectangular&#39;, &#39;bubble&#39;, 200) | Score: -2.59
Tested params: (&#39;zscore&#39;, 5, 6, &#39;hexagonal&#39;, &#39;gaussian&#39;, 50) | Score: 83.97
Tested params: (&#39;zscore&#39;, 5, 6, &#39;hexagonal&#39;, &#39;gaussian&#39;, 100) | Score: 74.98
Tested params: (&#39;zscore&#39;, 5, 6, &#39;hexagonal&#39;, &#39;gaussian&#39;, 200) | Score: 72.04
Tested params: (&#39;zscore&#39;, 5, 6, &#39;hexagonal&#39;, &#39;bubble&#39;, 50) | Score: 7.37
Tested params: (&#39;zscore&#39;, 5, 6, &#39;hexagonal&#39;, &#39;bubble&#39;, 100) | Score: 7.94
Tested params: (&#39;zscore&#39;, 5, 6, &#39;hexagonal&#39;, &#39;bubble&#39;, 200) | Score: 1.47
Tested params: (&#39;zscore&#39;, 7, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 50) | Score: 56.91
Tested params: (&#39;zscore&#39;, 7, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 100) | Score: 46.95
Tested params: (&#39;zscore&#39;, 7, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 200) | Score: 49.48
Tested params: (&#39;zscore&#39;, 7, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 50) | Score: -9.63
Tested params: (&#39;zscore&#39;, 7, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 100) | Score: -10.19
Tested params: (&#39;zscore&#39;, 7, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 200) | Score: 37.30
Tested params: (&#39;zscore&#39;, 7, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 50) | Score: 61.36
Tested params: (&#39;zscore&#39;, 7, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 100) | Score: 69.85
Tested params: (&#39;zscore&#39;, 7, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 200) | Score: 34.88
Tested params: (&#39;zscore&#39;, 7, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 50) | Score: -9.63
Tested params: (&#39;zscore&#39;, 7, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 100) | Score: -3.89
Tested params: (&#39;zscore&#39;, 7, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 200) | Score: 40.95
Tested params: (&#39;zscore&#39;, 7, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 50) | Score: 60.39
Tested params: (&#39;zscore&#39;, 7, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 100) | Score: 70.44
Tested params: (&#39;zscore&#39;, 7, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 200) | Score: 38.54
Tested params: (&#39;zscore&#39;, 7, 4, &#39;rectangular&#39;, &#39;bubble&#39;, 50) | Score: 7.52
Tested params: (&#39;zscore&#39;, 7, 4, &#39;rectangular&#39;, &#39;bubble&#39;, 100) | Score: -1.38
Tested params: (&#39;zscore&#39;, 7, 4, &#39;rectangular&#39;, &#39;bubble&#39;, 200) | Score: -0.51
Tested params: (&#39;zscore&#39;, 7, 4, &#39;hexagonal&#39;, &#39;gaussian&#39;, 50) | Score: 74.47
Tested params: (&#39;zscore&#39;, 7, 4, &#39;hexagonal&#39;, &#39;gaussian&#39;, 100) | Score: 53.62
Tested params: (&#39;zscore&#39;, 7, 4, &#39;hexagonal&#39;, &#39;gaussian&#39;, 200) | Score: 66.44
Tested params: (&#39;zscore&#39;, 7, 4, &#39;hexagonal&#39;, &#39;bubble&#39;, 50) | Score: 15.36
Tested params: (&#39;zscore&#39;, 7, 4, &#39;hexagonal&#39;, &#39;bubble&#39;, 100) | Score: 3.38
Tested params: (&#39;zscore&#39;, 7, 4, &#39;hexagonal&#39;, &#39;bubble&#39;, 200) | Score: 3.83
Tested params: (&#39;zscore&#39;, 7, 6, &#39;rectangular&#39;, &#39;gaussian&#39;, 50) | Score: 51.34
Tested params: (&#39;zscore&#39;, 7, 6, &#39;rectangular&#39;, &#39;gaussian&#39;, 100) | Score: 58.08
Tested params: (&#39;zscore&#39;, 7, 6, &#39;rectangular&#39;, &#39;gaussian&#39;, 200) | Score: 67.50
Tested params: (&#39;zscore&#39;, 7, 6, &#39;rectangular&#39;, &#39;bubble&#39;, 50) | Score: 38.08
Tested params: (&#39;zscore&#39;, 7, 6, &#39;rectangular&#39;, &#39;bubble&#39;, 100) | Score: 33.44
Tested params: (&#39;zscore&#39;, 7, 6, &#39;rectangular&#39;, &#39;bubble&#39;, 200) | Score: 25.62
Tested params: (&#39;zscore&#39;, 7, 6, &#39;hexagonal&#39;, &#39;gaussian&#39;, 50) | Score: 72.78
Tested params: (&#39;zscore&#39;, 7, 6, &#39;hexagonal&#39;, &#39;gaussian&#39;, 100) | Score: 75.29
Tested params: (&#39;zscore&#39;, 7, 6, &#39;hexagonal&#39;, &#39;gaussian&#39;, 200) | Score: 71.43
Tested params: (&#39;zscore&#39;, 7, 6, &#39;hexagonal&#39;, &#39;bubble&#39;, 50) | Score: 40.32
Tested params: (&#39;zscore&#39;, 7, 6, &#39;hexagonal&#39;, &#39;bubble&#39;, 100) | Score: 44.36
Tested params: (&#39;zscore&#39;, 7, 6, &#39;hexagonal&#39;, &#39;bubble&#39;, 200) | Score: 30.94
Tested params: (&#39;minmax&#39;, 3, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 50) | Score: 54.92
Tested params: (&#39;minmax&#39;, 3, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 100) | Score: 73.38
Tested params: (&#39;minmax&#39;, 3, 2, &#39;rectangular&#39;, &#39;gaussian&#39;, 200) | Score: 77.83
Tested params: (&#39;minmax&#39;, 3, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 50) | Score: 42.49
Tested params: (&#39;minmax&#39;, 3, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 100) | Score: 62.43
Tested params: (&#39;minmax&#39;, 3, 2, &#39;rectangular&#39;, &#39;bubble&#39;, 200) | Score: 73.67
Tested params: (&#39;minmax&#39;, 3, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 50) | Score: 79.08
Tested params: (&#39;minmax&#39;, 3, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 100) | Score: 79.40
Tested params: (&#39;minmax&#39;, 3, 2, &#39;hexagonal&#39;, &#39;gaussian&#39;, 200) | Score: 79.19
Tested params: (&#39;minmax&#39;, 3, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 50) | Score: 42.49
Tested params: (&#39;minmax&#39;, 3, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 100) | Score: 62.43
Tested params: (&#39;minmax&#39;, 3, 2, &#39;hexagonal&#39;, &#39;bubble&#39;, 200) | Score: 73.67
Tested params: (&#39;minmax&#39;, 3, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 50) | Score: 71.42
Tested params: (&#39;minmax&#39;, 3, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 100) | Score: 54.54
Tested params: (&#39;minmax&#39;, 3, 4, &#39;rectangular&#39;, &#39;gaussian&#39;, 200) | Score: 67.86
Tested params: (&#39;minmax&#39;, 3, 4, &#39;rectangular&#39;, &#39;bubble&#39;, 50) | Score: 75.14
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">KeyboardInterrupt</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-intense-fg ansi-bold">In[6], line 22</span>
<span class="ansi-green-fg">     11</span> <span style="color: rgb(95,135,135)"># Train SOM with the current hyperparameter combination</span>
<span class="ansi-green-fg">     12</span> som <span style="color: rgb(98,98,98)">=</span> SOM(
<span class="ansi-green-fg">     13</span>     train_dat<span style="color: rgb(98,98,98)">=</span>train_dat,
<span class="ansi-green-fg">     14</span>     other_dat<span style="color: rgb(98,98,98)">=</span>other_dat,
<span class="ansi-green-intense-fg ansi-bold">   (...)</span>
<span class="ansi-green-fg">     20</span>     epochs<span style="color: rgb(98,98,98)">=</span>epochs,
<span class="ansi-green-fg">     21</span> )
<span class="ansi-green-intense-fg ansi-bold">---&gt; 22</span> <span class="ansi-yellow-bg">som</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">train_map</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">     24</span> <span style="color: rgb(95,135,135)"># Calculate evaluation metrics</span>
<span class="ansi-green-fg">     25</span> pve <span style="color: rgb(98,98,98)">=</span> som<span style="color: rgb(98,98,98)">.</span>calculate_percent_variance_explained()

File <span class="ansi-green-intense-fg ansi-bold">~\OneDrive - UCB-O365\Grad School\Courses\Fa2024\SoftwareDevelopment\SOM_Seq_Sim\SOM\utils\som_utils.py:370</span>, in <span class="ansi-cyan-fg">SOM.train_map</span><span class="ansi-blue-intense-fg ansi-bold">(self)</span>
<span class="ansi-green-fg">    367</span> som<span style="color: rgb(98,98,98)">.</span>pca_weights_init(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>train_dat_scaled)
<span class="ansi-green-fg">    369</span> <span style="color: rgb(95,135,135)"># SOM training</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 370</span> <span class="ansi-yellow-bg">som</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">train</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">    371</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">train_dat_scaled</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    372</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">num_iteration</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">epochs</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">n_samples</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    373</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">random_order</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">True</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    374</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">verbose</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">False</span>
<span class="ansi-green-fg">    375</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    377</span> <span style="color: rgb(95,135,135)"># Set attributes yielded from training</span>
<span class="ansi-green-fg">    378</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>map <span style="color: rgb(98,98,98)">=</span> som

File <span class="ansi-green-intense-fg ansi-bold">~\miniforge3\envs\class-env\Lib\site-packages\minisom.py:407</span>, in <span class="ansi-cyan-fg">MiniSom.train</span><span class="ansi-blue-intense-fg ansi-bold">(self, data, num_iteration, random_order, verbose)</span>
<span class="ansi-green-fg">    404</span> iterations <span style="color: rgb(98,98,98)">=</span> _build_iteration_indexes(<span style="color: rgb(0,135,0)">len</span>(data), num_iteration,
<span class="ansi-green-fg">    405</span>                                       verbose, random_generator)
<span class="ansi-green-fg">    406</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> t, iteration <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">enumerate</span>(iterations):
<span class="ansi-green-intense-fg ansi-bold">--&gt; 407</span>     <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">update</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">iteration</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">winner</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">data</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg">iteration</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    408</span> <span class="ansi-yellow-bg">                </span><span class="ansi-yellow-bg">t</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">num_iteration</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    409</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> verbose:
<span class="ansi-green-fg">    410</span>     <span style="color: rgb(0,135,0)">print</span>(<span style="color: rgb(175,0,0)">&#39;</span><span class="ansi-bold" style="color: rgb(175,95,0)">\n</span><span style="color: rgb(175,0,0)"> quantization error:</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>quantization_error(data))

File <span class="ansi-green-intense-fg ansi-bold">~\miniforge3\envs\class-env\Lib\site-packages\minisom.py:338</span>, in <span class="ansi-cyan-fg">MiniSom.update</span><span class="ansi-blue-intense-fg ansi-bold">(self, x, win, t, max_iteration)</span>
<span class="ansi-green-fg">    336</span> g <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>neighborhood(win, sig)<span style="color: rgb(98,98,98)">*</span>eta
<span class="ansi-green-fg">    337</span> <span style="color: rgb(95,135,135)"># w_new = eta * neighborhood_function * (x-w)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 338</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_weights <span style="color: rgb(98,98,98)">+</span><span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">einsum</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">ij, ijk-&gt;ijk</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">g</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">-</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_weights</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-red-intense-fg ansi-bold">KeyboardInterrupt</span>:
</pre></div></div>
</div>
</section>
<section id="5.-Show-the-best-parameters">
<h1>5. Show the best parameters<a class="headerlink" href="#5.-Show-the-best-parameters" title="Permalink to this heading">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Output the best hyperparameters</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Best Hyperparameters:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scale Method: </span><span class="si">{</span><span class="n">best_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x_dim: </span><span class="si">{</span><span class="n">best_params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y_dim: </span><span class="si">{</span><span class="n">best_params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Topology: </span><span class="si">{</span><span class="n">best_params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Neighborhood Function: </span><span class="si">{</span><span class="n">best_params</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Epochs: </span><span class="si">{</span><span class="n">best_params</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best Score: </span><span class="si">{</span><span class="n">best_score</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Best Hyperparameters:
Scale Method: zscore
x_dim: 5
y_dim: 6
Topology: hexagonal
Neighborhood Function: gaussian
Epochs: 50
Best Score: 83.97
</pre></div></div>
</div>
</section>
<section id="6.-Train-SOM">
<h1>6. Train SOM<a class="headerlink" href="#6.-Train-SOM" title="Permalink to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train and visualize the best SOM</span>
<span class="n">best_som</span> <span class="o">=</span> <span class="n">SOM</span><span class="p">(</span>
    <span class="n">train_dat</span><span class="o">=</span><span class="n">train_dat</span><span class="p">,</span>
    <span class="n">other_dat</span><span class="o">=</span><span class="n">other_dat</span><span class="p">,</span>
    <span class="n">scale_method</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">x_dim</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">y_dim</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">topology</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
    <span class="n">neighborhood_fnc</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
    <span class="n">epochs</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">best_som</span><span class="o">.</span><span class="n">train_map</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="7.-Get-the-Fit-Metrics">
<h1>7. Get the Fit Metrics<a class="headerlink" href="#7.-Get-the-Fit-Metrics" title="Permalink to this heading">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get fit metrics</span>
<span class="n">pve</span> <span class="o">=</span> <span class="n">best_som</span><span class="o">.</span><span class="n">calculate_percent_variance_explained</span><span class="p">()</span>
<span class="n">topographic_error</span> <span class="o">=</span> <span class="n">best_som</span><span class="o">.</span><span class="n">calculate_topographic_error</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Final SOM Performance:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Percent variance explained = </span><span class="si">{</span><span class="n">pve</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Topographic error = </span><span class="si">{</span><span class="n">topographic_error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Final SOM Performance:
Percent variance explained = 90.69350053664347%
Topographic error = 0.06722689075630252
</pre></div></div>
</div>
</section>
<section id="8.-Plot-component-planes-and-categorical-data-(see-output-directory-for-figures)">
<h1>8. Plot component planes and categorical data (see output directory for figures)<a class="headerlink" href="#8.-Plot-component-planes-and-categorical-data-(see-output-directory-for-figures)" title="Permalink to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot component planes</span>
<span class="n">best_som</span><span class="o">.</span><span class="n">plot_component_planes</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;output/titanic&quot;</span><span class="p">)</span>

<span class="c1"># Plot SOM Map Using Categorical Data</span>
<span class="n">best_som</span><span class="o">.</span><span class="n">plot_categorical_data</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;output/titanic&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../references.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">References &amp; Acknowledgements</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../som_example_titanic.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">SOM Example Titanic</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Victoria Hurd
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Hyperparameter Tuning Example for Self-Organizing Maps (SOM)</a><ul>
<li><a class="reference internal" href="#Features-of-This-Script:">Features of This Script:</a></li>
<li><a class="reference internal" href="#Considerations:">Considerations:</a></li>
<li><a class="reference internal" href="#Output:">Output:</a></li>
<li><a class="reference internal" href="#Usage:">Usage:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#1.-Imports">1. Imports</a></li>
<li><a class="reference internal" href="#2.-Load-Data">2. Load Data</a></li>
<li><a class="reference internal" href="#3.-Define-Hyperparameters">3. Define Hyperparameters</a></li>
<li><a class="reference internal" href="#4.-Grid-Search-for-Optimal-Parameters">4. Grid Search for Optimal Parameters</a></li>
<li><a class="reference internal" href="#5.-Show-the-best-parameters">5. Show the best parameters</a></li>
<li><a class="reference internal" href="#6.-Train-SOM">6. Train SOM</a></li>
<li><a class="reference internal" href="#7.-Get-the-Fit-Metrics">7. Get the Fit Metrics</a></li>
<li><a class="reference internal" href="#8.-Plot-component-planes-and-categorical-data-(see-output-directory-for-figures)">8. Plot component planes and categorical data (see output directory for figures)</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=359c27e9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>