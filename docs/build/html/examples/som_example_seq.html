<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="SOM Example Titanic" href="../som_example_titanic.html" /><link rel="prev" title="SOM Example Seq" href="../som_example_seq.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.08.06 -->
        <title>Application of Self-Organizing Maps (SOM) for Cell Type Identification - SOM_Seq_Sim 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">SOM_Seq_Sim 1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/som_package_logo.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">SOM_Seq_Sim 1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Project Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html"><strong>Self-Organizing Maps to Explore Genetic Sequencing Simulation Data (SOM-Seq)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_overview.html">Data Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules.html">Core Function Descriptions</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Core Function Descriptions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../SOM_Seq_Sim.html">SOM Core Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Seq_Sim.html">Seq_Sim Core Functions</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Setup &amp; Walkthroughs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generate_data.html">Generating Sequencing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../make_soms.html">Creating SOMs</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../walkthrough.html">Walkthroughs</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Walkthroughs</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../seq_sim_workflow.html">Seq Sim Workflow</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Seq Sim Workflow</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="seq_sim_workflow.html">1. Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="seq_sim_workflow.html#2.-Specify-Number-of-Samples-and-Fold-Change">2. Specify Number of Samples and Fold Change</a></li>
<li class="toctree-l3"><a class="reference internal" href="seq_sim_workflow.html#3.-Specify-Configuration-File-Parameters">3. Specify Configuration File Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="seq_sim_workflow.html#4.-Generate-and-Save-Sequencing-Data">4. Generate and Save Sequencing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="seq_sim_workflow.html#5.-Ensure-files-were-saved-properly">5. Ensure files were saved properly</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../som_example_iris.html">SOM Example Iris</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of SOM Example Iris</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html">Basic Example of Using the Self-Organizing Map (SOM) Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html#1.-Imports">1. Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html#2.-Load-Data">2. Load Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html#3.-Train-SOM">3. Train SOM</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html#4.-Get-Fit-Metrics">4. Get Fit Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_iris.html#5.-Plot-SOM's-(see-output-directory-for-figures)">5. Plot SOM’s (see output directory for figures)</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../som_example_seq.html">SOM Example Seq</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of SOM Example Seq</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Application of Self-Organizing Maps (SOM) for Cell Type Identification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1.-Imports">1. Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Load-Data">2. Load Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.-Train-SOM">3. Train SOM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.-Plot-layout-of-SOM-with-neuron-IDs">4. Plot layout of SOM with neuron IDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#5.-Plot-component-planes-and-categorical-data-(see-output-directory-for-figures)">5. Plot component planes and categorical data (see output directory for figures)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#6.-Custom-plotting-for-seq-visualization-for-each-neuron">6. Custom plotting for seq visualization for each neuron</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../som_example_titanic.html">SOM Example Titanic</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of SOM Example Titanic</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="som_example_titanic.html">Hyperparameter Tuning Example for Self-Organizing Maps (SOM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_titanic.html#1.-Imports">1. Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_titanic.html#2.-Load-Data">2. Load Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_titanic.html#3.-Define-Hyperparameters">3. Define Hyperparameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_titanic.html#4.-Grid-Search-for-Optimal-Parameters">4. Grid Search for Optimal Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_titanic.html#5.-Show-the-best-parameters">5. Show the best parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_titanic.html#6.-Train-SOM">6. Train SOM</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_titanic.html#7.-Get-the-Fit-Metrics">7. Get the Fit Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="som_example_titanic.html#8.-Plot-component-planes-and-categorical-data-(see-output-directory-for-figures)">8. Plot component planes and categorical data (see output directory for figures)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References &amp; Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/caterer-z-t/SOM_Seq_Sim">Link to Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing to SOM_Seq_Sim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT.html">Code of Conduct - SOM_Seq_Sim</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/examples/som_example_seq.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="Application-of-Self-Organizing-Maps-(SOM)-for-Cell-Type-Identification">
<h1>Application of Self-Organizing Maps (SOM) for Cell Type Identification<a class="headerlink" href="#Application-of-Self-Organizing-Maps-(SOM)-for-Cell-Type-Identification" title="Permalink to this heading">¶</a></h1>
<p>This script demonstrates the original application for which the SOM class and associated project were developed: identifying different cell types based on simulated single-cell data. By training a Self-Organizing Map (SOM) on high-dimensional data, this script allows for efficient clustering and visualization of different cell types.</p>
<section id="Key-Features:">
<h2>Key Features:<a class="headerlink" href="#Key-Features:" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Application-Specific Data:</p>
<ul class="simple">
<li><p>The training data represents pseudo-features derived from simulated single-cell experiments.</p></li>
<li><p>Additional data (<code class="docutils literal notranslate"><span class="pre">other_dat</span></code>) includes the cell type (and other categorical data) labels for visualizing categorical clustering results.</p></li>
</ul>
</li>
<li><p>Visualization of Results:</p>
<ul class="simple">
<li><p>The SOM grid is used to map and visualize cell-type distributions.</p></li>
<li><p>By examining the output figures, it becomes evident that the SOM successfully identifies distinct cell types based on the input data.</p></li>
</ul>
</li>
<li><p>Efficient Handling of High-Dimensional Data:</p>
<ul class="simple">
<li><p>The SOM can handle 1000 features in the training data, making it suitable for large-scale single-cell datasets.</p></li>
</ul>
</li>
</ol>
</section>
<section id="Considerations:">
<h2>Considerations:<a class="headerlink" href="#Considerations:" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Output Figures:</p>
<ul class="simple">
<li><p>Generating component planes for all 1000 features produces a large number of figures. Uncomment the relevant section of the script to enable this visualization if desired.</p></li>
</ul>
</li>
<li><p>Cell Type Identification:</p>
<ul class="simple">
<li><p>The SOM’s ability to separate and group different cell types can be verified by analyzing the categorical data visualizations. Each cell type forms distinct clusters, demonstrating the SOM’s effectiveness in preserving topology and capturing meaningful patterns in high- dimensional data.</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section id="1.-Imports">
<h1>1. Imports<a class="headerlink" href="#1.-Imports" title="Permalink to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standard imports</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Third party imports</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Local imports</span>
<span class="n">notebook_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">parent_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">notebook_dir</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent_dir</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">SOM.utils.som_utils</span> <span class="kn">import</span> <span class="n">SOM</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Load-Data">
<h1>2. Load Data<a class="headerlink" href="#2.-Load-Data" title="Permalink to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load data</span>
<span class="n">train_dat_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parent_dir</span><span class="p">,</span> <span class="s1">&#39;SOM&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;seq_sim_training_data.csv&#39;</span><span class="p">)</span>
<span class="n">other_dat_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parent_dir</span><span class="p">,</span> <span class="s1">&#39;SOM&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;seq_sim_categorical_data.csv&#39;</span><span class="p">)</span>

<span class="n">train_dat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">train_dat_path</span><span class="p">)</span>
<span class="n">other_dat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">other_dat_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="3.-Train-SOM">
<h1>3. Train SOM<a class="headerlink" href="#3.-Train-SOM" title="Permalink to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train SOM</span>
<span class="n">som</span> <span class="o">=</span> <span class="n">SOM</span><span class="p">(</span>
    <span class="n">train_dat</span><span class="o">=</span><span class="n">train_dat</span><span class="p">,</span>
    <span class="n">other_dat</span><span class="o">=</span><span class="n">other_dat</span><span class="p">,</span>
    <span class="n">scale_method</span><span class="o">=</span><span class="s2">&quot;zscore&quot;</span><span class="p">,</span>
    <span class="n">x_dim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">y_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">topology</span><span class="o">=</span><span class="s2">&quot;hexagonal&quot;</span><span class="p">,</span>
    <span class="n">neighborhood_fnc</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span>
<span class="p">)</span>

<span class="c1"># Train SOM Map</span>
<span class="n">som</span><span class="o">.</span><span class="n">train_map</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="4.-Plot-layout-of-SOM-with-neuron-IDs">
<h1>4. Plot layout of SOM with neuron IDs<a class="headerlink" href="#4.-Plot-layout-of-SOM-with-neuron-IDs" title="Permalink to this heading">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">som</span><span class="o">.</span><span class="n">plot_map_grid</span><span class="p">(</span><span class="n">print_neuron_idx</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_som_example_seq_8_0.png" src="../_images/examples_som_example_seq_8_0.png" />
</div>
</div>
</section>
<section id="5.-Plot-component-planes-and-categorical-data-(see-output-directory-for-figures)">
<h1>5. Plot component planes and categorical data (see output directory for figures)<a class="headerlink" href="#5.-Plot-component-planes-and-categorical-data-(see-output-directory-for-figures)" title="Permalink to this heading">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Since there are 1000  features, this creates 1000 figures. Uncomment if you want to create</span>
<span class="c1"># these figures</span>
<span class="c1"># som.plot_component_planes(</span>
<span class="c1">#     output_dir=&quot;output/seq&quot;</span>
<span class="c1"># )</span>

<span class="c1"># Plot SOM Map Using Categorical Data</span>
<span class="n">som</span><span class="o">.</span><span class="n">plot_categorical_data</span><span class="p">(</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;output/seq&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="6.-Custom-plotting-for-seq-visualization-for-each-neuron">
<h1>6. Custom plotting for seq visualization for each neuron<a class="headerlink" href="#6.-Custom-plotting-for-seq-visualization-for-each-neuron" title="Permalink to this heading">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span> <span class="o">-</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">neuron_observations</span> <span class="o">=</span> <span class="n">train_dat</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">som</span><span class="o">.</span><span class="n">observation_mapping</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">200</span><span class="p">]</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">neuron_observations</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
        <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Neuron </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_som_example_seq_12_0.png" src="../_images/examples_som_example_seq_12_0.png" />
</div>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../som_example_titanic.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">SOM Example Titanic</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../som_example_seq.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">SOM Example Seq</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Victoria Hurd
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Application of Self-Organizing Maps (SOM) for Cell Type Identification</a><ul>
<li><a class="reference internal" href="#Key-Features:">Key Features:</a></li>
<li><a class="reference internal" href="#Considerations:">Considerations:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#1.-Imports">1. Imports</a></li>
<li><a class="reference internal" href="#2.-Load-Data">2. Load Data</a></li>
<li><a class="reference internal" href="#3.-Train-SOM">3. Train SOM</a></li>
<li><a class="reference internal" href="#4.-Plot-layout-of-SOM-with-neuron-IDs">4. Plot layout of SOM with neuron IDs</a></li>
<li><a class="reference internal" href="#5.-Plot-component-planes-and-categorical-data-(see-output-directory-for-figures)">5. Plot component planes and categorical data (see output directory for figures)</a></li>
<li><a class="reference internal" href="#6.-Custom-plotting-for-seq-visualization-for-each-neuron">6. Custom plotting for seq visualization for each neuron</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=359c27e9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>